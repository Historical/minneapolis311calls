extends layout

block extraHeader
    link(rel='stylesheet', href='stylesheets/landlordSearch.css')


block content
   div.container
    div.row
     div.col-md-4
      div.panel.panel-default
       div.panel-heading
        i.kv-icon.fa.fa-briefcase
        span Owner: #{landlordName}
     div.col-md-4
      div.panel.panel-default
       div.panel-heading
        i.kv-icon.fa.fa-briefcase
        span Owner Since: #{moment(ownerSinceDate).format('MM/DD/YYYY')}
     div.col-md-4
      div.panel.panel-default
       div.panel-heading
        i.kv-icon.fa.fa-briefcase
        span Properties Owned: #{propertyCountForOwner} &nbsp;
         a(href="#AllPropertiesMap") (View Map)

    div
    table.table.table-striped#results
      thead
        tr
          th #
          th Address
          th Type
          th Date of Incident
      tbody
        each rrow, i in calls311
          tr
            td #{i+1}
            td#address #{calls311[i].Address}
            td #{calls311[i].TypeName}
            td #{moment(calls311[i].OpenedDateTime).format('MM-DD-YYYY')}

    div.row
        div.col-md-12
            div.panel.panel-default
            div.panel-heading.text-align-center Properties Owned
            div#AllPropertiesMap

block script
    script(src="/javascripts/leaflet.js")
    script(type='text/javascript').
        $(document).ready(function() {
                $('#results').DataTable();
            });
        function onEachFeature(feature, layer) {
          if (feature.properties && feature.properties.pop_up_text) {
            layer.bindPopup(feature.properties.pop_up_text);
          }
        };
        var mymap = L.map('AllPropertiesMap')
        if (#{propertyCountForOwner} > 1){
          mymap.fitBounds(#{bbox});
        }
        else{
          var bbox = #{bbox}
          mymap.setView(bbox[0], 17)}
        L.tileLayer('http://a.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mymap);
        var geo = !{geo}
        L.geoJson(geo, {
          onEachFeature: onEachFeature
        }).addTo(mymap)
